{% extends 'accounts/base.html' %}

{% block content %}
    {% if not user.hospital %}
        <div class="alert alert-info text-center">
            <h3>Ожидание подтверждения</h3>
            <p>Ваша учетная запись еще не привязана к больнице.</p>
            <p>Обратитесь к администратору для получения доступа к системе.</p>
            <a href="{% url 'logout' %}" class="btn btn-secondary mt-3">Выйти</a>
        </div>
    {% else %}
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Добро пожаловать, {{ user.full_name }}!</h2>
            <a href="{% url 'logout' %}" class="btn btn-danger">Выход</a>
        </div>

        <h3 class="mb-3">Отделения больницы "{{ user.hospital.name }}":</h3>
        {% if departments %}
            <div class="list-group">
                {% for department in departments %}
                    <a href="{% url 'department' department.id %}" class="list-group-item list-group-item-action">
                        {{ department.name }} ({{ department.code }})
                        {% if department not in user.departments.all %}
                            <span class="badge badge-secondary float-right">Не назначено вам</span>
                        {% endif %}
                    </a>
                {% endfor %}
            </div>
        {% else %}
            <div class="alert alert-info">В этой больнице пока нет отделений</div>
        {% endif %}

        <div class="mt-4">
            <a href="{% url 'patients' %}" class="btn btn-primary btn-lg">Работа с пациентами</a>
        </div>
    {% endif %}
{% endblock %}